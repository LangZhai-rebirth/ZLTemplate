/**
 * ZLTemplate 2.0.0
 * Date: 2017-05-17
 * © 2016-2017 LangZhai(智能小菜菜)
 * This is licensed under the GNU LGPL, version 3 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl.html
 * Project home: https://github.com/LangZhai/ZLTemplate
 */
Object.extend=function(){var t,e;return"boolean"==typeof arguments[0]?(t=[].slice.call(arguments,1),e=arguments[0]):t=[].slice.call(arguments),t.forEach(function(n){if(n instanceof Object)for(var o in n)n.hasOwnProperty(o)&&(t[0][o]=e?Object.extend(e,{},n[o]):n[o]);else t[0]=n}),t[0]},Object.encodeEntity=function(t){if(t instanceof Object){t=Object.extend(t instanceof Array?[]:{},t);for(var e in t)t.hasOwnProperty(e)&&(t[e]=Object.encodeEntity(t[e]))}else"string"==typeof t&&(t=t.replaceAll(/&(?!(\S(?!&))+;)/,"&amp;").replaceAll(">","&gt;").replaceAll("<","&lt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"));return t},Object.decodeEntity=function(t){if(t instanceof Object){t=Object.extend(t instanceof Array?[]:{},t);for(var e in t)t.hasOwnProperty(e)&&(t[e]=Object.decodeEntity(t[e]))}else"string"==typeof t&&(t=t.replaceAll("&amp;","&").replaceAll("&gt;",">").replaceAll("&lt;","<").replaceAll("&quot;",'"').replaceAll("&#39;","'"));return t},Object.getVal=function(t,e){return e.split(".").some(function(e){return void 0===(t=t[e])}),t},String.prototype.replaceAll=function(t,e,n){return RegExp.prototype.isPrototypeOf(t)?this.replace(t,e):this.replace(new RegExp(t,n?"gi":"g"),e)},function(window){var ZLTemplate=function(t){return new ZLTemplate.prototype.init(t)};ZLTemplate.prototype.init=function(t){if("string"==typeof t){var e=document.querySelectorAll(t);return Object.extend(this,e),this.length=e.length,this}return t.nodeType?(this[0]=t,this.length=1,this):t},ZLTemplate.prototype.template=function(data,options){var _this=this,binds,val,result,index,last,nestedCol,nested={};return options=options||{},index=options.index||0,last=void 0===options.last||options.last,data instanceof Array?(result="",data.forEach(function(t,e){result+=_this.template(t,Object.extend({},options,{index:e,last:e===data.length-1}))})):(result=this[0].innerHTML,options.rule=options.rule||/#{(.(?!#{))*[^\n\r\f\t\v\0]}/g,binds=result.match(options.rule),data=Object.encodeEntity(data),data instanceof Object&&void 0!==options.nested&&(options.nested instanceof Array?options.nested=options.nested.map(function(t){return t instanceof ZLTemplate?t:ZLTemplate(t)}):"string"==typeof options.nested?options.nested=options.nested.length?options.nested.split(",").map(function(t){return ZLTemplate(t)}):[]:options.nested instanceof ZLTemplate?options.nested=[].map.call(options.nested,function(t){return ZLTemplate(t)}):options.nested=[],options.nested.forEach(function(t){nestedCol=t[0].getAttribute("data-nested"),nested[t[0].getAttribute("data-alias")||nestedCol]=t.template(Object.getVal(data,nestedCol),options)})),binds.forEach(function(item){val=item.substring(2);try{val=eval(Object.decodeEntity(val.substring(0,val.length-1)))}catch(t){val=void 0}void 0!==val?result=result.replace(item,val):(void 0===options.clean||options.clean)&&(result=result.replace(item,""))})),result},ZLTemplate.prototype.init.prototype=ZLTemplate.prototype,window.ZLTemplate=ZLTemplate}(window);