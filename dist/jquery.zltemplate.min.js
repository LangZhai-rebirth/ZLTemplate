/**
 * ZLTemplate 1.0.4
 * Date: 2016-09-06
 * © 2016 LangZhai(智能小菜菜)
 * This is licensed under the GNU LGPL, version 3 or later.
 * For details, see: http://www.gnu.org/licenses/lgpl.html
 * Project home: https://github.com/LangZhai/ZLTemplate
 */
Object.encodeEntity=function(t){return t instanceof Object?(t=$.extend({},t),$.each(Object.keys(t),function(e,n){t[n]=Object.encodeEntity(t[n])})):"string"==typeof t&&(t=t.replaceAll("&","&amp;").replaceAll(">","&gt;").replaceAll("<","&lt;").replaceAll('"',"&quot;").replaceAll("'","&#x27;")),t},Object.decodeEntity=function(t){return t instanceof Object?(t=$.extend({},t),$.each(Object.keys(t),function(e,n){t[n]=Object.decodeEntity(t[n])})):"string"==typeof t&&(t=t.replaceAll("&amp;","&").replaceAll("&gt;",">").replaceAll("&lt;","<").replaceAll("&quot;",'"').replaceAll("&#x27;","'")),t},Object.getVal=function(t,e){return $.each(e.split("."),function(e,n){return t=t[n],void 0===t?!1:void 0}),t},String.prototype.replaceAll=function(t,e,n){return RegExp.prototype.isPrototypeOf(t)?this.replace(t,e):this.replace(RegExp(t,n?"gi":"g"),e)},function($){$.fn.template=function(data,options){var $this=$(this),binds,val,result,index,last,nestedCol,nested={};return options=options||{},index=options.index||0,last=void 0===options.last||options.last,data instanceof Array?(result="",$.each(data,function(t,e){result+=$this.template(e,$.extend({},options,{index:t,last:t===data.length-1}))})):(result=$this.html(),options.rule=options.rule||/#{(.(?!#{))*[^\n\r\f\t\v\0]}/g,binds=result.match(options.rule),data=Object.encodeEntity(data),data instanceof Object&&void 0!==options.nested&&(options.nested instanceof Array?options.nested=$.map(options.nested,function(t){return t instanceof $?t:$(t)}):"string"==typeof options.nested?options.nested=options.nested.length?$.map(options.nested.split(","),function(t){return $(t)}):[]:options.nested instanceof $?options.nested=options.nested.map(function(){return $(this)}):options.nested=[],$.each(options.nested,function(t,e){nestedCol=e.data("nested"),nested[e.data("alias")||nestedCol]=e.template(Object.getVal(data,nestedCol),options)})),$.each(binds,function(i,item){val=item.substring(2);try{val=eval(val.substring(0,val.length-1).replaceAll("&amp;","&").replaceAll("&gt;",">").replaceAll("&lt;","<"))}catch(err){val=void 0}void 0!==val?result=result.replace(item,val):(void 0===options.clean||options.clean)&&(result=result.replace(item,""))})),result}}($);